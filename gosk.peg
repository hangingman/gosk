package main

type Parser Peg {
	s Scan
}

root <- text EOT                   / # 正しいテキスト
	text <.+> {p.s.Err(begin)} EOT / # エラー
	<.+> {p.s.Err(begin)} EOT        # エラー

# 複数行のテキスト
text <- line line*

# コメント行と通常の行
line <- <&';' [^\n]* '\n'> {
	p.s.line++;
	p.s.lineHead = begin + 1
	fmt.Printf("line %d (%d) COMMENTS\t%s", p.s.line, begin - p.s.lineHead, text)
} / <[^\n]* '\n'> {
	fmt.Printf("line %d (%d) OTHER\t%s", p.s.line, begin - p.s.lineHead, text)
}

EOT <- !.